# Unity (Shannon) Configuration Template
# Copy this to config.yaml and customize for your project
#
# *Burrrp* â€” Configure Unity's security scanning, Morty.

# Target configuration
target:
  # Base URL for live testing (optional)
  # Leave null for code-only analysis
  url: null

  # Repository path for code analysis
  # Default: current working directory
  repo: "."

  # Scope of testing
  # - full: Complete security assessment
  # - quick: Fast scan, common vulnerabilities only
  # - recon: Reconnaissance and information gathering
  # - exploit: Focus on exploitation and PoC generation
  scope: "full"

# Authentication (for testing authenticated endpoints)
auth:
  # Bearer token for API authentication
  token: null

  # Cookie-based authentication
  # Format: "session=abc123; csrf=xyz789"
  cookies: null

  # Basic authentication
  basic:
    username: null
    password: null

  # OAuth2 configuration
  oauth2:
    client_id: null
    client_secret: null
    token_url: null

# Scanning options
scan:
  # Enable/disable specific scan types
  enabled:
    - sast          # Static Application Security Testing
    - dast          # Dynamic Application Security Testing (requires url)
    - secrets       # Secret and credential detection
    - dependencies  # Dependency vulnerability scanning
    - config        # Configuration security review

  # Disable specific scan types
  disabled: []

  # Exclude patterns (glob syntax)
  exclude:
    paths:
      - "node_modules/**"
      - "vendor/**"
      - ".git/**"
      - "*.min.js"
      - "*.min.css"
      - "dist/**"
      - "build/**"
      - "__pycache__/**"
      - ".venv/**"

    # Exclude specific vulnerability rules
    rules: []
    # Example:
    # - "info-*"           # All informational findings
    # - "ssl-weak-cipher"  # Specific rule

# Severity configuration
severity:
  # Only report findings >= this level
  # Options: critical, high, medium, low, info
  threshold: "low"

  # Treat these severities as failures
  fail_on:
    - critical
    - high

# Output configuration
output:
  # Report formats to generate
  formats:
    - json      # Machine-readable
    - markdown  # Human-readable

  # Output directory (relative to .cto/)
  directory: "unity/reports"

  # Include raw tool output in reports
  include_raw: false

  # Maximum findings per category in summary
  max_findings_summary: 10

# Temporal configuration (for async workflow execution)
temporal:
  # Temporal server address
  address: "localhost:7233"

  # Temporal namespace
  namespace: "default"

  # Task queue for Unity workers
  task_queue: "unity-security"

  # Workflow timeout (in seconds)
  workflow_timeout: 3600  # 1 hour

# Rate limiting (to avoid overwhelming target)
rate_limit:
  # Maximum requests per second
  rps: 10

  # Maximum concurrent connections
  concurrency: 5

  # Delay between requests (milliseconds)
  delay_ms: 100

# Timeouts (in seconds)
timeouts:
  # Per-request timeout
  request: 30

  # Per-tool timeout
  tool: 300  # 5 minutes

  # Total scan timeout
  total: 3600  # 1 hour

# Tool-specific configuration
tools:
  # Nuclei vulnerability scanner
  nuclei:
    enabled: true
    templates:
      - "cves"
      - "vulnerabilities"
      - "misconfigurations"
    severity: "medium,high,critical"

  # Nmap network scanner
  nmap:
    enabled: false  # Disabled by default (requires network access)
    ports: "1-1000"
    scripts: "default,vuln"

  # Subfinder subdomain enumeration
  subfinder:
    enabled: false  # Disabled by default
    sources: "all"

  # WhatWeb fingerprinting
  whatweb:
    enabled: true
    aggression: 1  # 1-4, higher = more aggressive

  # Secret scanning
  secrets:
    enabled: true
    patterns:
      - "api[_-]?key"
      - "secret"
      - "password"
      - "token"
      - "credential"
      - "private[_-]?key"

# OWASP Top 10 specific checks
owasp:
  # Enable all OWASP Top 10 checks
  enabled: true

  # Specific categories to focus on
  focus:
    - "A01:2021-Broken Access Control"
    - "A02:2021-Cryptographic Failures"
    - "A03:2021-Injection"
    - "A07:2021-Identification and Authentication Failures"

# Reporting customization
report:
  # Include remediation recommendations
  include_remediation: true

  # Include code snippets for findings
  include_code_snippets: true

  # Maximum snippet length
  max_snippet_length: 500

  # Group findings by category
  group_by: "category"  # category, severity, file

# Notifications (optional)
notifications:
  # Slack webhook for critical findings
  slack:
    enabled: false
    webhook_url: null
    on_severity:
      - critical

  # Email notifications
  email:
    enabled: false
    to: null
    on_severity:
      - critical
      - high

# Advanced options
advanced:
  # Run in debug mode (verbose output)
  debug: false

  # Keep intermediate files
  keep_temp: false

  # Custom environment variables for tools
  env: {}

  # Proxy configuration
  proxy:
    http: null
    https: null
